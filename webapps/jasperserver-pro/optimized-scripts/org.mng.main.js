function invokeOrgAction(e,t){var n=orgModule.orgActionFactory[e](t);n.invokeAction()}function invokeOrgManagerAction(e,t){var n=orgModule.orgManager.actionFactory[e](t);n.invokeAction()}function canAddOrg(){return!_.isUndefined(orgModule.manager.tenantsTree.getTenant())}function canDeleteAll(){return orgModule.entityList.getSelectedEntities().length>0}function canDeleteUser(){return orgModule.entityList.getSelectedEntities().length>0}orgModule.orgManager={NAME_REG_EXP:null,ID_REG_EXP:null,ID_REG_EXP_FOR_REPLACEMENT:null,ALIAS_REG_EXP:null,ALIAS_REG_EXP_FOR_REPLACEMENT:null,Event:{},Action:{ALIAS_EXIST:"aliasExist"},initialize:function(e){layoutModule.resizeOnClient("folders","organizations","properties"),webHelpModule.setCurrentContext("admin");var t=_.extend(e,localContext.orgMngInitOptions);this.NAME_REG_EXP=new RegExp(orgModule.Configuration.tenantNameNotSupportedSymbols),this.ID_REG_EXP=new RegExp(orgModule.Configuration.tenantIdNotSupportedSymbols),this.ID_REG_EXP_FOR_REPLACEMENT=new RegExp(orgModule.Configuration.tenantIdNotSupportedSymbols,"g"),this.ALIAS_REG_EXP=new RegExp(orgModule.Configuration.tenantIdNotSupportedSymbols),this.ALIAS_REG_EXP_FOR_REPLACEMENT=new RegExp(orgModule.Configuration.tenantIdNotSupportedSymbols,"g"),orgModule.manager.initialize(t),orgModule.manager.entityJsonToObject=function(e){return new orgModule.Organization(e)},this.orgList.initialize({toolbarModel:this.actionModel,text:orgModule.manager.state.text}),orgModule.addDialog.show=function(e){this.addDialog.show(e)}.bind(this),orgModule.addDialog.hide=function(e){this.addDialog.hide(e)}.bind(this),this.properties.initialize(e),this.addDialog.initialize(),orgModule.observe("entity:created",function(e){var t=orgModule.orgManager.addDialog.organization,n=JSON.parse(e.memo.inputData.entity),o=t.isRoot()?"organizations":t.id;n.tenantFolderUri=t.isRoot()?"/"+o+"/"+n.tenantName:t.uri+"/"+n.tenantName,n.parentId=n.parentId||o,orgModule.manager.tenantsTree.addTenant(o,n)}.bindAsEventListener(this)),orgModule.observe("entity:updated",function(e){var t=JSON.parse(e.memo.inputData.entity);if(t){var n=orgModule.manager.tenantsTree,o=orgModule.entityList.getSelectedEntities(),i=n.getTenant(),a=_.isObject(i.parentId)?i.parentId.parentId:i.parentId,r=o.length&&t.tenantId!==i.id?i.id:a,d=!o.length||t.tenantId===i.id;orgModule.manager.tenantsTree.setTenant("name",t.tenantName),orgModule.properties.setValuesProperty("name",t.tenantName),t.tenantName!==i.name&&orgModule.manager.tenantsTree.updateTenant(r,t,d)}}.bindAsEventListener(this)),orgModule.observe("searchAssigned:loaded",function(e){var t=e.memo.responseData;this.properties.setAssigned(t.usersCount,t.rolesCount)}.bindAsEventListener(this)),orgModule.observe("entity:detailsLoaded",function(e){invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED,{text:""})}.bindAsEventListener(this)),orgModule.observe("entity:deleted",function(e){var t=orgModule.manager.tenantsTree,n=e.memo.inputData,o=n.entity,i=n.entityEvent,a=t.getTenant(),r=i?a.id:a.parentId;t.removeTenant(o,r),!i&&t.selectTenant(r),orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS,{entityId:r,entityEvent:!1})}.bindAsEventListener(this)),orgModule.observe("entities:deleted",function(e){var t=orgModule.manager.tenantsTree,n=t.getTenant().id,o=JSON.parse(e.memo.inputData.entities);t.removeTenant(o,n),orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS,{entityId:n,entityEvent:!0})}.bindAsEventListener(this)),orgModule.observe("server:unavailable",function(e){var t=orgModule.manager.tenantsTree,n=t?t.getTenant().id:null,o=new orgModule.Organization({tenantId:n});o.navigateToManager()}.bindAsEventListener(this))},actionModel:{ADD:{buttonId:"addNewOrgBtn",action:invokeClientAction,actionArgs:"create",test:canAddOrg},DELETE:{buttonId:"deleteAllOrgsBtn",action:invokeClientAction,actionArgs:"deleteAll",test:canDeleteAll}}},"undefined"==typeof require&&document.observe("dom:loaded",orgModule.orgManager.initialize.bind(orgModule.orgManager));