define(["require","backbone","underscore","settings!decimalFormatSymbols","common/util/parse/NumberUtils","common/util/parse/date","common/util/parse/time","jrs.configs","adhoc/filter/validation/ValidationError","adhoc/filter/validation/validationMessageCodes","backbone.validation"],function(e){"use strict";var n=e("backbone"),i=e("underscore"),r=e("settings!decimalFormatSymbols"),t=e("common/util/parse/NumberUtils"),a=new t(r),o=e("common/util/parse/date"),l=e("common/util/parse/time"),u=e("jrs.configs"),s=e("adhoc/filter/validation/ValidationError"),d=e("adhoc/filter/validation/validationMessageCodes");e("backbone.validation");var A=s.ATTRIBUTE_INDEX_SEPARATOR,g=u.inputControlsConstants&&u.inputControlsConstants.NULL_SUBSTITUTION_VALUE?u.inputControlsConstants.NULL_SUBSTITUTION_VALUE.toLowerCase():"~null~",m="~BLANK~",I=function(e){return!(i.isNull(e)||i.isUndefined(e)||i.isString(e)&&""===e)},c=function(e,r,t,a,o){for(var l,u=[],s=0;s<e.length;s++){l=void 0;for(var d in o)if(l=n.Validation.validators[d](e[s],r+A+(s+1),o[d],a),!i.isUndefined(l))break;u.push(l)}return i.reject(u,function(e){return i.isUndefined(e)})};return i.extend(n.Validation.validators,{required:function(e,n,r,t,a){var o=i.isFunction(r)?r.call(t,e,n,a):r;return o||I(e)?o&&!I(e)?new s(e,n,d.REQUIRED,"required"):void 0:!1},integer:function(e,n,i,r){return a.isInt(e)?void 0:new s(e,n,d.INVALID_INTEGER,"integer")},integerRange:function(e,n,r,t){if(!i.isArray(e)||2!==e.length)return new s(e,n,d.INVALID_RANGE,"integerRange");var o=c(e,n,!0,t,{required:!0,nullable:!1,integer:!0});if(o.length)return o;var l=a.parseNumber(e[0]),u=a.parseNumber(e[1]);return l>u?new s(e,n,d.START_BIGGER_THAN_END,"integerRange"):void 0},listWithTrueAll:function(e,n,r,t,a){return i.isArray(e)&&e.length>0||a.isAnyValue===!0?void 0:new s(e,n,d.INVALID_TRUE_ALL_LIST,"listWithTrueAll")},list:function(e,n,r,t,a){return i.isArray(e)?void 0:new s(e,n,d.INVALID_LIST,"list")},decimal:function(e,n,i,r){return a.isDecimal(e)?void 0:new s(e,n,d.INVALID_DECIMAL,"decimal")},decimalRange:function(e,n,r,t){if(!i.isArray(e)||2!==e.length)return new s(e,n,d.INVALID_RANGE,"decimalRange");var o=c(e,n,r,t,{required:!0,nullable:!1,decimal:!0});if(o.length)return o;var l=a.parseNumber(e[0]),u=a.parseNumber(e[1]);return l>u?new s(e,n,d.START_BIGGER_THAN_END,"decimalRange"):void 0},"long":function(e,n,i,r){return a.isInt(e)?void 0:new s(e,n,d.INVALID_LONG,"long")},longRange:function(e,n,r,t){if(!i.isArray(e)||2!==e.length)return new s(e,n,d.INVALID_RANGE,"longRange");var o=c(e,n,r,t,{required:!0,nullable:!1,"long":!0});if(o.length)return o;var l=a.parseNumber(e[0]),u=a.parseNumber(e[1]);if(l!==!1&&u!==!1)return l>u?new s(e,n,d.START_BIGGER_THAN_END,"longRange"):void 0},string:function(e,n,r,t){return i.isString(e)?void 0:new s(e,n,d.INVALID_STRING,"string")},nullable:function(e,n,r,t){return r===!0&&i.isString(e)&&g===e.toLowerCase()?!1:r===!1&&i.isString(e)&&g===e.toLowerCase()?new s(e,n,d.NOT_NULLABLE,"nullable"):void 0},stringRange:function(e,n,r,t){if(!i.isArray(e)||2!==e.length)return new s(e,n,d.INVALID_RANGE,"stringRange");var a=c(e,n,r,t,{required:!0,string:!0,nullable:!1});return a.length?a:void 0},date:function(e,n,i,r){return o.isDate(e)||o.isRelativeDate(e)?void 0:new s(e,n,d.INVALID_DATE,"date")},dateRange:function(e,n,r,t){if(!i.isArray(e)||2!==e.length)return new s(e,n,d.INVALID_RANGE,"dateRange");var a=c(e,n,r,t,{required:!0,nullable:!1,date:!0});if(a.length)return a;var l=o.compareDates(e[0],e[1]);return"undefined"!=typeof l&&l>0?new s(e,n,d.START_DATE_LATER_THAN_FINISH,"dateRange"):void 0},timestamp:function(e,n,i,r){return o.isTimestamp(e)||o.isRelativeTimestamp(e)?void 0:new s(e,n,d.INVALID_TIMESTAMP,"timestamp")},timestampRange:function(e,n,r,t){if(!i.isArray(e)||2!==e.length)return new s(e,n,d.INVALID_RANGE,"timestampRange");var a=c(e,n,r,t,{required:!0,nullable:!1,timestamp:!0});if(a.length)return a;var l=o.compareTimestamps(e[0],e[1]);return"undefined"!=typeof l&&l>0?new s(e,n,d.START_DATE_LATER_THAN_FINISH,"timestampRange"):void 0},time:function(e,n,i,r){return l.isTime(e)?void 0:new s(e,n,d.INVALID_TIME,"time")},timeRange:function(e,n,r,t){if(!i.isArray(e)||2!==e.length)return new s(e,n,d.INVALID_RANGE,"timeRange");var a=c(e,n,r,t,{required:!0,nullable:!1,time:!0});if(a.length)return a;var o=l.compareTimes(e[0],e[1]);return"undefined"!=typeof o&&o>0?new s(e,n,d.START_TIME_LATER_THAN_FINISH,"timeRange"):void 0},"boolean":function(e,n,r,t){return i.isBoolean(e)||i.isString(e)&&i.include(["true","false"],e.toLowerCase())?void 0:new s(e,n,d.INVALID_BOOLEAN,"boolean")},blank:function(e,n,i,r){return i===!0&&e===m?!1:i===!1&&e===m?new s(e,n,d.NOT_BLANK,"blank"):void 0}}),n.Validation});