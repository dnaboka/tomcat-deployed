define(["require","jquery","bundle!all","jrs.configs","backbone.marionette","common/component/dialog/LoadingDialog","logCollectors/view/CreateLogCollectorView","logCollectors/collectionView/LogCollectorCollectionView"],function(o){"use strict";var e=o("jquery"),l=o("bundle!all"),i=o("jrs.configs"),t=o("backbone.marionette"),n=o("common/component/dialog/LoadingDialog"),r=o("logCollectors/view/CreateLogCollectorView"),c=o("logCollectors/collectionView/LogCollectorCollectionView");return t.Application.extend({initialize:function(o){this.options=o,this.$el=e(this.options.container),this.addRegions({LogCollectorRegion:t.Region.extend({el:this.$el})}),this.loadingDialog=new n({content:l["dialog.overlay.loading"]}),this.createLogCollectorView=new r(null,this.options),this.listenTo(this.createLogCollectorView,"logCollectorHasBeenCreated",this.logCollectorHasBeenCreated),this.listenTo(this.createLogCollectorView,"cancelButtonClick",this.creatingFormCancelButtonClick),this.logCollectorCollectionView=new c([],this.options),this.listenTo(this.logCollectorCollectionView,"createNewCollectorClick",this.createNewCollectorClick),this.logCollectorCollectionView.render(),this.LogCollectorRegion.show(this.logCollectorCollectionView,{preventDestroy:!0}),this.logCollectorCollectionView.refreshListOfCollectors()},createNewCollectorClick:function(){this.createLogCollectorView.prepareNewModel(),this.createLogCollectorView.render(),this.LogCollectorRegion.show(this.createLogCollectorView,{preventDestroy:!0}),this.logCollectorCollectionView.removeOverClassOnButtons()},logCollectorHasBeenCreated:function(o){this.logCollectorCollectionView.appendNewlyCreatedLogCollector(o),this.openLoadingDialog();var e=this;this.logCollectorCollectionView.refreshListOfCollectors().done(function(){e.closeLoadingDialog()}),this.LogCollectorRegion.show(this.logCollectorCollectionView,{preventDestroy:!0})},creatingFormCancelButtonClick:function(){this.LogCollectorRegion.show(this.logCollectorCollectionView,{preventDestroy:!0})},setTitle:function(o){e(i.logCollectors.initParams.container+" div.content .title").text(o)},openLoadingDialog:function(o){if(this.loadingDialogIsOpened!==!0){o=o||250;var e=this;this.loadingDialogTimerHandler=setTimeout(function(){e.loadingDialogIsOpened=!0,e.loadingDialog.open()},o)}},closeLoadingDialog:function(){this.loadingDialogTimerHandler&&(clearTimeout(this.loadingDialogTimerHandler),this.loadingDialogTimerHandler=!1),this.loadingDialogIsOpened!==!1&&(this.loadingDialog.close(),this.loadingDialogIsOpened=!1)}})});