define(["require","home/view/ListView","home/util/cookie","underscore","text!home/template/expandableBlockTemplate.htm","home/view/ListView","bundle!accessibility_messages"],function(e){"use strict";var t=e("home/view/ListView"),i=e("home/util/cookie"),a=e("underscore"),s=e("text!home/template/expandableBlockTemplate.htm"),r=(e("home/view/ListView"),e("bundle!accessibility_messages")),o={COLLAPSED:"0",EXPANDED:"1"};return t.extend({template:s,events:{"click .resourceBlock-header":"toggleList"},listStateCookieName:function(){return this.stateKey+"State"},toggleList:function(){var e=this.$(".buttonIconToggle"),t=this.$block;t.is(":visible")?(e.removeClass("isOpen"),e.addClass("isClosed"),t.hide(),i.set(this.listStateCookieName(),o.COLLAPSED)):(e.removeClass("isClosed"),e.addClass("isOpen"),t.show(),i.set(this.listStateCookieName(),o.EXPANDED)),this.renderAria()},initialize:function(e){this.$block=e.$block,this.title=e.title,this.expandedAtStart=e.expandedAtStart,this.stateKey=e.stateKey},dataToRender:function(){var e,t=!0,s=!a.isUndefined(this.expandedAtStart)&&this.expandedAtStart;return s||(e=i.get(this.listStateCookieName()),t=e!==o.COLLAPSED),{isExpanded:t,title:this.title}},render:function(){var e=this.dataToRender();return this.setElement(a.template(this.template,e)),this.$block&&(this.$el.append(this.$block),e.isExpanded?this.$block.show():this.$block.hide()),this.renderAria(),this},renderAria:function(){var e=this.$(".buttonIconToggle"),t=this.dataToRender(),i=this.title+" "+r["expander.aria.label.suffix"]+", ";return i+=t.isExpanded?r["expander.aria.state.expanded"]:r["expander.aria.state.collapsed"],e.attr("aria-busy","true"),e.attr("aria-label",i),e.attr("role","alert"),e.attr("aria-live","assertive"),e.attr("aria-busy","false"),e.removeAttr("aria-busy"),this}})});