define(["require","../BaseInputControlView","jquery","underscore","components/sizer/Sizer","components/multiSelect/view/MultiSelect","components/multiSelect/dataprovider/DataProviderWithLabelHash","mustache","../../util/inputControlHelpers","text!../../template/multiSelectTemplate.htm"],function(t){"use strict";var e=t("../BaseInputControlView"),i=t("jquery"),s=(t("underscore"),t("components/sizer/Sizer"),t("components/multiSelect/view/MultiSelect")),l=t("components/multiSelect/dataprovider/DataProviderWithLabelHash"),n=t("mustache"),o=t("../../util/inputControlHelpers"),a=t("text!../../template/multiSelectTemplate.htm");return e.extend({template:a,renderStructure:function(){var t=this;this.multiSelect||(this.dataProvider=new l,this.multiSelect=new s({getData:this.dataProvider.getData,selectedListOptions:{formatLabel:function(e){return t.dataProvider.getDataLabelHash()[e]}},resizable:!0}),this.multiSelect.setDisabled(this.model.get("readOnly"))),this.template&&(this.multiSelect.undelegateEvents(),this.setElement(i(n.to_html(this.template,this.model.toJSON()))),this.multiSelect.render().renderData(),this.$el.find(".jr-mInput-label").after(this.multiSelect.el),this.multiSelect.$el.find(".jr-mSizer").detach().insertAfter(this.$el.find(".jr-mInput-alert")),this.multiSelect.delegateEvents(),this.updateOptionsSelection())},updateOptionsSelection:function(){var t=this.model.state.options.toJSON();this.dataProvider.setData(t);var e=this;this.multiSelect.fetch(function(){var i=o.extractSelection(t);e.multiSelect.setValue(i,{silent:!0}),e.multiSelect.resize()},{keepPosition:!0})},bindCustomEventListeners:function(){this.multiSelect.off("selection:change").on("selection:change",function(t){this.model.changeState(t)},this),this.model.state.options.on("reset",this.updateOptionsSelection,this),this.model.state.options.on("change:selected",this.updateOptionsSelection,this)},remove:function(){this.multiSelect.remove(),this.model.state.options.off("reset",this.updateOptionsSelection,this),this.model.state.options.off("change:selected",this.updateOptionsSelection,this),e.prototype.remove.call(this)}})});