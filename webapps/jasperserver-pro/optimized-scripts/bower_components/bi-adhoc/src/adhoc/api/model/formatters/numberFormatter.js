define(["require","underscore","bundle!AdHocBundle","./formatsMappingUtil","jrs.configs"],function(n){function r(n,r,t,i,u,s,o){var f,d="-"===n[0];return d&&(n=n.substring(1)),f=e(n,i||0,u||0,o,t),s&&(f=s+f),d&&(f=r?"("+f+")":"-"+f),f}function e(n,r,e,t,i){var u,s=n.split("."),o=s[0],f=s[1]||"",d=s[1]?+("0."+f):0,A=f.length;if(A=Math.max(A,r),A=Math.min(A,e)){if(f.length>A)f=d.toFixed(A).substring(2),0===+f&&Math.round(d)&&(o=(+o+1).toString());else if(f.length<A)for(var a=f.length;A>a;a++)f+="0"}else o.length<17&&Math.round(d)&&(o=(+o+1).toString());if(i){u=[];for(var a=o.length-3;a>=0;a-=3)u.push(o.substr(a,3));3+a>0&&u.push(o.substr(0,3+a)),o=u.reverse().join(i)}return A?o+(t||".")+f:o}function t(n){var r={THOUSAND:","};return 0===n.indexOf("es")||0===n.indexOf("de")||0===n.indexOf("it")||0===n.indexOf("pt_BR")?(r.DECIMAL=",",r.THOUSAND="."):0===n.indexOf("fr")&&(r.DECIMAL=",",r.THOUSAND=" "),r}var i=(n("underscore"),n("bundle!AdHocBundle"),n("./formatsMappingUtil")),u=n("jrs.configs"),s={format:function(n,e,s){var o=t(u.userLocale);return i.isNullOrEmpty(n)?"":i.isOtherNode(n)?n:"#,##0.00"===e?r(n,!1,o.THOUSAND,2,2,!1,o.DECIMAL):"0"===e?r(n,!1,"",0,0):"$#,##0.00;($#,##0.00)"===e?r(n,!0,o.THOUSAND,2,2,"$",o.DECIMAL):"$#,##0;($#,##0)"===e?r(n,!0,o.THOUSAND,0,0,"$"):"$#,##0.000#############"===e?r(n,!1,o.THOUSAND,3,16,"$",o.DECIMAL):"$#,##0,00;($#,##0,00)"===e?r(n,!0,o.THOUSAND,2,2,"$",o.DECIMAL):"#,##0"===e?r(n,!1,o.THOUSAND,0,0):"$#,##0;($#,##0)"===e?r(n,!0,o.THOUSAND,0,0,"$"):"#,##0;(#,##0)"===e?r(n,!0,o.THOUSAND,0,0):n}};return s});