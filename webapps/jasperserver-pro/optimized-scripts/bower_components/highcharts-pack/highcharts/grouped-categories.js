!function(t,i){"use strict";"object"==typeof module&&module.exports?module.exports=t:"function"==typeof define&&define.amd?define(["highcharts"],t):t(i.Highcharts)}(function(t){function i(t,i){return this.userOptions=l(t),this.name=e(t.name)?t.name:t,this.parent=i,this}function e(t){return t!==c&&null!==t}function s(t){for(var i=t.length,e=0;i--;)e+=t[i];return e}function r(t,i,e,s,o){var n,h=t.length;for(o||(o=0),e.depth||(e.depth=0);h--;)n=t[h],s&&(n.parent=s),n.categories?r(n.categories,i,e,n,o+1):a(i,n,s);e.depth=u(e.depth,o)}function a(t,e,s){for(t.unshift(new i(e,s));s;)s.leaves++||(s.leaves=1),s=s.parent}function o(t,i,e){i[0]===i[2]&&(i[0]=i[2]=d(i[0])-e%2/2),i[1]===i[3]&&(i[1]=i[3]=d(i[1])+e%2/2),t.push("M",i[0],i[1],"L",i[2],i[3])}function n(t,i){return t.getPosition(t.axis.horiz,i,t.axis.tickmarkOffset)}function h(t,i,e){for(var s,r=t.length;r--;)s=t[r][i],s&&h(s,i,e),e(t[r])}function l(t){return JSON.parse(JSON.stringify(t))}var c=void 0,d=Math.round,p=Math.min,u=Math.max,f=t.merge,g=t.pick,x=window.HighchartsAdapter&&window.HighchartsAdapter.inArray||t.inArray,b=t.Axis.prototype,y=t.Tick.prototype,v=b.init,k=b.render,G=b.setCategories,m=y.getLabelSize,z=y.addLabel,L=y.destroy,S=y.render;return i.prototype.toString=function(){for(var t=[],i=this;i;)t.push(i.name),i=i.parent;return t.join(", ")},b.init=function(t,i){v.call(this,t,i),"object"==typeof i&&i.categories&&this.setupGroups(i)},b.setupGroups=function(t){var i,e=[],s={};i=l(t.categories),r(i,e,s),this.categoriesTree=i,this.categories=e,this.isGrouped=0!==s.depth,this.labelsDepth=s.depth,this.labelsSizes=[],this.labelsGridPath=[],this.tickLength=t.tickLength||this.tickLength||null,this.tickWidth=g(t.tickWidth,this.isXAxis?1:0),this.directionFactor=[-1,1,1,-1][this.side],"undefined"==typeof t.lineWidth?this.options.lineWidth=1:this.options.lineWidth=g(t.lineWidth,1)},b.render=function(){if(this.isGrouped&&(this.labelsGridPath=[]),this.originalTickLength===c&&(this.originalTickLength=this.options.tickLength),this.options.tickLength=this.isGrouped?.001:this.originalTickLength,k.call(this),!this.isGrouped)return void(this.labelsGrid&&this.labelsGrid.attr({visibility:"hidden"}));var t,i=this,e=i.options,s=i.top,r=i.left,a=r+i.width,n=s+i.height,l=i.hasVisibleSeries||i.hasData,d=i.labelsDepth,p=i.labelsGrid,u=i.horiz,f=i.labelsGridPath,g=e.drawHorizontalBorders===!1?d+1:0,x=i.opposite?u?s:a:u?n:r,b=i.tickWidth;for(i.userTickLength&&(d-=1),p||(p=i.labelsGrid=i.chart.renderer.path().attr({strokeWidth:b,"stroke-width":b,stroke:e.tickColor}).add(i.axisGroup));d>=g;)x+=i.groupSize(g),t=u?[r,x,a,x]:[x,s,x,n],o(f,t,b),g++;p.attr({d:f,visibility:l?"visible":"hidden"}),i.labelGroup.attr({visibility:l?"visible":"hidden"}),h(i.categoriesTree,"categories",function(t){var e=t.tick;e&&(e.startAt+e.leaves-1<i.min||e.startAt>i.max?(e.label.hide(),e.destroyed=0):e.label.attr({visibility:l?"visible":"hidden"}))})},b.setCategories=function(t,i){this.categories&&this.cleanGroups(),this.setupGroups({categories:t}),this.categories=this.userOptions.categories=t,G.call(this,this.categories,i)},b.cleanGroups=function(){var t,i=this.ticks;for(t in i)i[t].parent&&delete i[t].parent;h(this.categoriesTree,"categories",function(t){var i,e=t.tick;if(e){e.label.destroy();for(i in e)delete e[i];delete t.tick}}),this.labelsGrid=null},b.groupSize=function(t,i){var e=this.labelsSizes,r=this.directionFactor,a=this.options.labels.groupedOptions?this.options.labels.groupedOptions[t-1]:!1,o=0;return a&&(o=-1==r?a.x?a.x:0:a.y?a.y:0),i!==c&&(e[t]=u(e[t]||0,i+10+Math.abs(o))),t===!0?s(e)*r:e[t]?e[t]*r:0},y.addLabel=function(){var t;z.call(this),this.axis.categories&&(t=this.axis.categories[this.pos])&&(this.label&&this.label.attr("text",this.axis.labelFormatter.call({axis:this.axis,chart:this.axis.chart,isFirst:this.isFirst,isLast:this.isLast,value:t.name})),this.axis.isGrouped&&this.axis.options.labels.enabled&&this.addGroupedLabels(t))},y.addGroupedLabels=function(t){for(var i,e=this,s=this.axis,r=s.chart,a=s.options.labels,o=a.useHTML,n=a.style,h=a.groupedOptions,l={align:"center",x:0,y:0},c=s.horiz?"height":"width",d=0;e;){if(d>0&&!t.tick){this.value=t.name;var p=a.formatter?a.formatter.call(this,t):t.name,u=h&&h[d-1],g=u?f(l,h[d-1]):l,x=u&&h[d-1].style?f(n,h[d-1].style):n;delete g.style,i=r.renderer.text(p,0,0,o).attr(g).css(x).add(s.labelGroup),e.startAt=this.pos,e.childCount=t.categories.length,e.leaves=t.leaves,e.visible=this.childCount,e.label=i,e.labelOffsets={x:g.x,y:g.y},t.tick=e}s.groupSize(d,e.label.getBBox()[c]),t=t.parent,e=t?e.parent=t.tick||{}:null,d++}},y.render=function(t,i,e){function s(t,i,e){var s=0;return k?(s=x(i.name,i.parent.categories),s=0>s?0:s):s}S.call(this,t,i,e);var r=this.axis.categories[this.pos];if(this.axis.isGrouped&&r&&!(this.pos>this.axis.max)){var a,h,l,c,d,f,g=this,b=g,y=g.axis,v=g.pos,k=g.isFirst,G=y.max,m=y.min,z=y.horiz,L=(y.categories[v],y.labelsGridPath),A=y.groupSize(0),O=(y.tickLength||A,y.tickWidth),w=(y.directionFactor,n(g,v)),T=z?w.y:w.x,W=y.chart.renderer.fontMetrics(y.options.labels.style.fontSize).b,F=1;for(k&&(a=z?[y.left,w.y,y.left,w.y+y.groupSize(!0)]:y.isXAxis?[w.x,y.top,w.x+y.groupSize(!0),y.top]:[w.x,y.top+y.len,w.x+y.groupSize(!0),y.top+y.len],o(L,a,O)),z&&y.left<w.x?o(L,[w.x,w.y,w.x,w.y+A],O):!z&&y.top<w.y&&o(L,[w.x,w.y,w.x+A,w.y],O),A=T+A;b=b.parent;){var M=s(b,r,g),N=b.labelOffsets.x,B=b.labelOffsets.y;l=n(g,u(b.startAt-1,m-1)),c=n(g,p(b.startAt+b.leaves-1-M,G)),f=b.label.getBBox(!0),h=y.groupSize(F),d=z?{x:(l.x+c.x)/2+N,y:A+h/2+W-f.height/2-4+B/2}:{x:A+h/2+N,y:(l.y+c.y-f.height)/2+W+B},isNaN(d.x)||isNaN(d.y)||(b.label.attr(d),L&&(z&&y.left<c.x?o(L,[c.x,A,c.x,A+h],O):!z&&y.top<c.y&&o(L,[A,c.y,A+h,c.y],O))),A+=h,F++}}},y.destroy=function(){for(var t=this;t=t.parent;)t.destroyed++||(t.destroyed=1);L.call(this)},y.getLabelSize=function(){if(this.axis.isGrouped===!0){var t=m.call(this)+10,i=this.axis.labelsSizes[0];return t>i&&(this.axis.labelsSizes[0]=t),s(this.axis.labelsSizes)}return m.call(this)},t},this);