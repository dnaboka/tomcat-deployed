define(["require","backbone","underscore","../model/BaseComponentMetaModel","logger"],function(e){function t(e){var t=1;if(e)if(o.isNumber(e))t=e;else try{t=parseInt(i.exec(e)[1],10)}catch(r){}return t--,t}var r=e("backbone"),o=e("underscore"),n=e("../model/BaseComponentMetaModel"),i=(e("logger").register("ReportComponentMetaCollection"),new RegExp("^(\\d+)(\\-\\d+)?$"));return r.Collection.extend({initialize:function(e,t){this.report=t.report},model:function(e,t){return new n(e,t)},url:function(){var e=this.report.contextPath;return"/"!==e[e.length-1]&&(e+="/"),e+="getReportComponents.html"},fetch:function(){if(!this.report.has("requestId"))throw new Error("You must run report first before fetching components.");return r.Collection.prototype.fetch.call(this,{type:"POST",reset:!0,headers:{Accept:"application/json","x-jrs-base-url":this.report.contextPath},data:{jasperPrintName:this.report.get("requestId"),pageIndex:t(this.report.execution.get("pages"))}})},parse:function(e){return o.values(e)}})});