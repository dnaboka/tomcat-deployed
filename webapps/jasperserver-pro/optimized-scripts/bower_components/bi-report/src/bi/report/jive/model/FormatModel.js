define(["require","backbone"],function(e){"use strict";var n=e("backbone"),r="###0",t="[h]:mm:ss",i={LOCALE_SPECIFIC:"\xa4",USD:"$",GBP:"\xa3",EUR:"\u20ac",YEN:"\xa5"};return n.Model.extend({defaults:function(){return{backgroundColor:void 0,align:void 0,font:{name:void 0,size:11,bold:!1,italic:!1,underline:!1,color:"000000"}}},initialize:function(e,n){n||(n={}),this.dataType=n.dataType},parse:function(e){var n={align:e.fontHAlign.toLowerCase(),backgroundColor:"Opaque"===e.mode?e.fontBackColor:"transparent",font:{name:e.fontName,size:parseFloat(e.fontSize),italic:e.fontItalic,bold:e.fontBold,underline:e.fontUnderline,color:e.fontColor}};if(e.formatPattern)if("numeric"===this.dataType&&t===e.formatPattern)n.pattern=e.formatPattern;else if("numeric"===this.dataType){var i=e.formatPattern,a=new RegExp("0\\.(0+)"),o=!1,c=!1,l=0,f="-"+r,p=null;i.indexOf(",")>-1&&(o=!0,i=i.replace(/,/g,"")),i.indexOf("%")>-1&&(c=!0,i=i.replace(/%/g,"")),i.indexOf("\xa4")>-1?(p="LOCALE_SPECIFIC",i=i.replace(/\u00A4/g,"")):i.indexOf("$")>-1?(p="USD",i=i.replace(/\u0024/g,"")):i.indexOf("\xa3")>-1?(p="GBP",i=i.replace(/\u00A3/g,"")):i.indexOf("\u20ac")>-1?(p="EUR",i=i.replace(/\u20AC/g,"")):i.indexOf("\xa5")>-1&&(p="YEN",i=i.replace(/\u00A5/g,"")),i=i.replace(/\s/g,"");var s=a.exec(i);s&&2==s.length&&(l=s[1].length,i=i.replace(new RegExp("\\."+Array(l+1).join("0"),"g"),""));var u=i.split(";");u&&2===u.length&&(f=u[1]),n.pattern={negativeFormat:f,currency:p,precision:l,grouping:o,percentage:c}}else n.pattern=e.formatPattern;return n},toJiveFormat:function(){if(this.has("pattern")){if("numeric"!==this.dataType||"numeric"===this.dataType&&t===this.get("pattern"))return this.get("pattern");var e=this.get("pattern"),n=r,a=e.negativeFormat||"-"+r;if(e.percentage&&(n+=" %",a+=" %"),e.currency&&i[e.currency]&&(n=i[e.currency]+" "+n,a=i[e.currency]+" "+a),e.grouping){var o=n.indexOf("#");n=n.slice(0,o)+"#,"+n.slice(o+1),o=a.indexOf("#"),a=a.slice(0,o)+"#,"+a.slice(o+1)}if(e.precision){var o=n.indexOf("##0");n=n.slice(0,o)+"##0."+Array(e.precision+1).join("0")+n.slice(o+3),o=a.indexOf("##0"),a=a.slice(0,o)+"##0."+Array(e.precision+1).join("0")+a.slice(o+3)}return n+";"+a}return""}})});